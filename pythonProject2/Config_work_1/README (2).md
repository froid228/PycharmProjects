
# Эмулятор оболочки для UNIX-подобной ОС

## Описание проекта

Этот проект реализует эмулятор оболочки командной строки, работающий в режиме CLI, который позволяет пользователю выполнять базовые команды в виртуальной файловой системе, находящейся в архиве ZIP. Эмулятор имитирует работу оболочки UNIX, поддерживает основные команды навигации и работы с файлами, а также выполняет команды, характерные для UNIX-систем.

## Структура проекта

Проект состоит из следующих файлов:

- `shell_emulator.py`: Основной скрипт, реализующий функциональность эмулятора.
- `test_shell_emulator.py`: Тесты для проверки корректной работы эмулятора и его команд.
- `config.json`: Конфигурационный файл, содержащий пути к архиву виртуальной файловой системы и лог-файлу для записи истории команд.
- `log.xml`: Лог-файл, автоматически создаваемый при запуске эмулятора и записывающий историю команд за текущий сеанс.

## Функциональность

Эмулятор поддерживает выполнение следующих команд:

- **ls**: Отображает список файлов и директорий в текущей директории.
- **cd <путь>**: Изменяет текущую директорию на указанную.
- **exit**: Завершает сеанс работы с эмулятором.
- **tac <файл>**: Отображает содержимое указанного файла в обратном порядке (с конца файла к началу).
- **pwd**: Выводит путь к текущей рабочей директории.
- **who**: Отображает имя текущего пользователя.

## Установка и требования

### Предварительные требования

Для запуска эмулятора необходимо:

- Установленная версия Python 3.x.
- Библиотеки Python:
  - `zipfile`: Для работы с ZIP-архивом.
  - `os`: Для работы с файловой системой.
  - `xml.etree.ElementTree`: Для ведения лог-файла в формате XML.

Установить дополнительные библиотеки можно с помощью `pip`:

```bash
pip install toml
```

### Конфигурационный файл

Эмулятор использует файл конфигурации в формате JSON, который содержит пути к архиву виртуальной файловой системы и к лог-файлу. Пример файла `config.json`:

```json
{
  "filesystem_path": "path/to/vfs.zip",
  "log_path": "path/to/log.xml"
}
```

- `filesystem_path`: Путь к ZIP-архиву, содержащему виртуальную файловую систему.
- `log_path`: Путь к XML-файлу, в который будет записываться история команд.

## Запуск эмулятора

Для запуска эмулятора выполните следующую команду в терминале:

```bash
python shell_emulator.py config.json
```

где `config.json` — это путь к конфигурационному файлу.

## Примеры использования команд

### Просмотр содержимого директории

```bash
> ls
file1.txt  file2.txt  directory1
```

### Переход в директорию

```bash
> cd directory1
```

### Показ текущей директории

```bash
> pwd
/directory1
```

### Отображение содержимого файла в обратном порядке

```bash
> tac file1.txt
```

### Выход из эмулятора

```bash
> exit
Exiting shell emulator.
```

## Логирование команд

Эмулятор сохраняет все действия текущего сеанса в XML-файл, указанный в конфигурации, чтобы отслеживать выполненные команды. Лог-файл перезаписывается при каждом запуске эмулятора.

## Структура кода

### Основной класс: `ShellEmulator`

Основные методы:

- **__init__(self, config_path)**: Инициализирует эмулятор и загружает конфигурацию.
- **load_virtual_fs(self)**: Загружает виртуальную файловую систему из ZIP-архива.
- **execute_command(self, command)**: Выполняет команду, указанную пользователем.
- **ls(self)**: Отображает содержимое текущей директории.
- **cd(self, path)**: Переходит в указанную директорию.
- **tac(self, filename)**: Выводит содержимое файла в обратном порядке.
- **pwd(self)**: Отображает текущий путь.
- **who(self)**: Выводит имя текущего пользователя.
- **exit_shell(self)**: Завершает работу эмулятора.

## Тестирование

Проект включает файл с тестами `test_shell_emulator.py`, содержащий набор тестов для проверки функциональности эмулятора. Тесты покрывают основные команды и функции оболочки.

### Запуск тестов

Чтобы запустить тесты, выполните следующую команду:

```bash
pytest test_shell_emulator.py
```

### Пример результата тестов

При успешном прохождении всех тестов:

```
==================================== test session starts ====================================
collected 10 items

test_shell_emulator.py ..........                                                         [100%]

Все тесты прошли успешно!
```

## Заключение

Этот эмулятор предоставляет базовый функционал для работы с виртуальной файловой системой, поддерживая популярные команды UNIX. Логирование всех действий в XML-файл делает его полезным для отладки и анализа.
